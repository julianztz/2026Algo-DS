# levelOrderBottom æ–¹æ³•å¯¹æ¯”åˆ†æ

## é—®é¢˜æè¿°

**LeetCode 107**: ç»™å®šäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿”å›è‡ªåº•å‘ä¸Šçš„å±‚åºéå†ç»“æœã€‚
- è¦æ±‚ï¼šä»å¶å­èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹ï¼Œä»å·¦åˆ°å³ï¼Œé€å±‚éå†

---

## æ–¹æ³•å¯¹æ¯”

### **æ–¹æ³•1ï¼šdeque.appendleft() + æœ€åè½¬listï¼ˆæ¨èï¼‰**

```python
def levelOrderBottom(root: Optional[TreeNode]) -> List[List[int]]:
    if not root:
        return []
        
    res_q = deque()
    q = deque([root])

    while q:
        sz = len(q)
        cur_lev_res = []
        for _ in range(sz):
            cur = q.popleft()
            
            if cur.left:
                q.append(cur.left)
            if cur.right:
                q.append(cur.right)

            cur_lev_res.append(cur.val)
        
        res_q.appendleft(cur_lev_res)  # O(1) æ“ä½œ

    return list(res_q)  # O(n) è½¬æ¢
```

**æ—¶é—´å¤æ‚åº¦ï¼šO(n)**
- æ¯å±‚ `appendleft()`: O(1) Ã— h å±‚ = O(h)
- æœ€å `list()` è½¬æ¢: O(n)
- æ€»æ—¶é—´: O(n)

**ç©ºé—´å¤æ‚åº¦ï¼šO(n)**
- å­˜å‚¨æ‰€æœ‰èŠ‚ç‚¹å€¼
- **æ³¨æ„**ï¼šä¸­é—´ä½¿ç”¨ `deque`ï¼Œæœ€åè½¬æ¢ä¸º `list`
- è½¬æ¢æ—¶ï¼š`deque` å’Œ `list` çŸ­æš‚åŒæ—¶å­˜åœ¨ï¼ˆPython GC ä¼šå¾ˆå¿«é‡Šæ”¾ `deque`ï¼‰
- å®é™…é¢å¤–ç©ºé—´ï¼šO(1) åˆ° O(h)ï¼ˆå–å†³äº `deque` çš„å†…éƒ¨å®ç°ï¼‰

---

### **æ–¹æ³•2ï¼šlist.insert(0, item)**

```python
def levelOrderBottom(root: Optional[TreeNode]) -> List[List[int]]:
    if not root:
        return []
        
    res = []  # æ™®é€š list
    q = deque([root])

    while q:
        sz = len(q)
        cur_lev_res = []
        for _ in range(sz):
            cur = q.popleft()
            
            if cur.left:
                q.append(cur.left)
            if cur.right:
                q.append(cur.right)

            cur_lev_res.append(cur.val)
        
        res.insert(0, cur_lev_res)  # O(n) æ“ä½œ âš ï¸

    return res
```

**æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)**
- ç¬¬1å±‚ï¼š`insert(0, ...)` ç§»åŠ¨ 0 ä¸ªå…ƒç´ 
- ç¬¬2å±‚ï¼š`insert(0, ...)` ç§»åŠ¨ 1 ä¸ªå…ƒç´ 
- ç¬¬3å±‚ï¼š`insert(0, ...)` ç§»åŠ¨ 2 ä¸ªå…ƒç´ 
- ...
- ç¬¬hå±‚ï¼š`insert(0, ...)` ç§»åŠ¨ (h-1) ä¸ªå…ƒç´ 
- æ€»ç§»åŠ¨æ¬¡æ•°ï¼š0 + 1 + 2 + ... + (h-1) = h(h-1)/2 = O(hÂ²)
- å¯¹äºå¹³è¡¡æ ‘ï¼šh = log(n)ï¼Œæ‰€ä»¥æ˜¯ O(n log n)
- å¯¹äºæœ€åæƒ…å†µï¼ˆé“¾çŠ¶æ ‘ï¼‰ï¼šh = nï¼Œæ‰€ä»¥æ˜¯ O(nÂ²)

**ç©ºé—´å¤æ‚åº¦ï¼šO(n)**
- å­˜å‚¨æ‰€æœ‰èŠ‚ç‚¹å€¼
- **ä¼˜åŠ¿**ï¼šåªéœ€è¦ä¸€ä¸ª `list`ï¼Œä¸éœ€è¦ä¸­é—´æ•°æ®ç»“æ„

---

## ç©ºé—´å¤æ‚åº¦è¯¦ç»†åˆ†æ

### **å…³é”®é—®é¢˜ï¼š`deque` è½¬ `list` éœ€è¦é¢å¤–ç©ºé—´å—ï¼Ÿ**

#### **æ–¹æ³•1ï¼šdeque.appendleft() + list()**

```python
res_q = deque()  # ä¸­é—´å­˜å‚¨ï¼šdeque
# ... æ·»åŠ æ•°æ® ...
return list(res_q)  # è½¬æ¢ï¼šåˆ›å»ºæ–°çš„ list
```

**ç©ºé—´ä½¿ç”¨è¿‡ç¨‹ï¼š**
1. **è¿è¡ŒæœŸé—´**ï¼š`deque` å­˜å‚¨ h å±‚æ•°æ® â†’ O(n) ç©ºé—´
2. **è½¬æ¢æ—¶**ï¼š`list(res_q)` åˆ›å»ºæ–°çš„ `list` å¯¹è±¡ â†’ O(n) ç©ºé—´
3. **è½¬æ¢å**ï¼š`deque` å¯¹è±¡è¢« Python GC å›æ”¶ï¼ˆé€šå¸¸å¾ˆå¿«ï¼‰

**å³°å€¼ç©ºé—´**ï¼šO(n) + O(n) = O(n)ï¼ˆçŸ­æš‚æ—¶é—´ï¼‰
- `deque` å’Œ `list` åŒæ—¶å­˜åœ¨çš„æ—¶é—´å¾ˆçŸ­
- Python çš„å¼•ç”¨è®¡æ•°ä¼šå¾ˆå¿«é‡Šæ”¾ `deque`

**å®é™…ç©ºé—´å¤æ‚åº¦**ï¼šO(n)
- è™½ç„¶è½¬æ¢æ—¶æœ‰çŸ­æš‚çš„åŒå€ç©ºé—´ï¼Œä½†è¿™æ˜¯å¸¸æ•°å› å­
- å¤§ O è¡¨ç¤ºæ³•å¿½ç•¥å¸¸æ•°å› å­

#### **æ–¹æ³•2ï¼šlist.insert(0, ...)**

```python
res = []  # åªæœ‰ä¸€ä¸ª list
# ... æ¯æ¬¡ insert(0, ...) ...
return res
```

**ç©ºé—´ä½¿ç”¨è¿‡ç¨‹ï¼š**
1. **è¿è¡ŒæœŸé—´**ï¼šåªæœ‰ä¸€ä¸ª `list`ï¼Œé€æ­¥å¢é•¿ â†’ O(n) ç©ºé—´
2. **è¿”å›æ—¶**ï¼šç›´æ¥è¿”å›ï¼Œæ— éœ€è½¬æ¢

**å³°å€¼ç©ºé—´**ï¼šO(n)
- å§‹ç»ˆåªæœ‰ä¸€ä¸ª `list`

**å®é™…ç©ºé—´å¤æ‚åº¦**ï¼šO(n)

---

### **ç©ºé—´å¯¹æ¯”æ€»ç»“**

| æ–¹æ³• | ä¸­é—´å­˜å‚¨ | æœ€ç»ˆå­˜å‚¨ | å³°å€¼ç©ºé—´ | ç©ºé—´å¤æ‚åº¦ |
|------|---------|---------|---------|-----------|
| **deque.appendleft()** | `deque` | `list` | çŸ­æš‚åŒå€ | **O(n)** |
| **list.insert(0)** | `list` | `list` | å•å€ | **O(n)** |

**ç»“è®º**ï¼š
- âœ… ä¸¤ç§æ–¹æ³•çš„**ç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ O(n)**
- âš ï¸ `deque` æ–¹æ³•åœ¨è½¬æ¢æ—¶æœ‰**çŸ­æš‚çš„é¢å¤–ç©ºé—´**ï¼ˆdeque + listï¼‰
- âœ… ä½†è¿™æ˜¯**å¸¸æ•°å› å­**ï¼Œä¸å½±å“å¤§ O å¤æ‚åº¦
- âœ… æ›´é‡è¦çš„æ˜¯ï¼š`deque` æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ **O(n)**ï¼Œè€Œ `list.insert(0)` æ˜¯ **O(nÂ²)**

---

## æ ¸å¿ƒåŒºåˆ«

### **1. æ•°æ®ç»“æ„ç‰¹æ€§**

#### **dequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰**
- **è®¾è®¡ç›®çš„**ï¼šé«˜æ•ˆçš„åŒç«¯æ“ä½œ
- **`appendleft()`**: O(1) - åœ¨å¤´éƒ¨æ’å…¥
- **`append()`**: O(1) - åœ¨å°¾éƒ¨æ’å…¥
- **`popleft()`**: O(1) - ä»å¤´éƒ¨å¼¹å‡º
- **`pop()`**: O(1) - ä»å°¾éƒ¨å¼¹å‡º

**å®ç°åŸç†**ï¼š
- ä½¿ç”¨åŒå‘é“¾è¡¨æˆ–å¾ªç¯æ•°ç»„
- å¤´éƒ¨å’Œå°¾éƒ¨éƒ½æœ‰æŒ‡é’ˆï¼Œæ’å…¥/åˆ é™¤ä¸éœ€è¦ç§»åŠ¨å…ƒç´ 

#### **listï¼ˆåˆ—è¡¨ï¼‰**
- **è®¾è®¡ç›®çš„**ï¼šé«˜æ•ˆçš„éšæœºè®¿é—®
- **`append()`**: O(1) - åœ¨å°¾éƒ¨è¿½åŠ ï¼ˆå¹³å‡æƒ…å†µï¼‰
- **`insert(0, item)`**: O(n) - åœ¨å¤´éƒ¨æ’å…¥ âš ï¸
- **`insert(i, item)`**: O(n) - åœ¨ä¸­é—´æ’å…¥
- **`[i]`**: O(1) - éšæœºè®¿é—®

**å®ç°åŸç†**ï¼š
- ä½¿ç”¨åŠ¨æ€æ•°ç»„ï¼ˆè¿ç»­å†…å­˜ï¼‰
- `insert(0, item)` éœ€è¦å°†æ‰€æœ‰å…ƒç´ å‘å³ç§»åŠ¨ä¸€ä½

---

### **2. æ€§èƒ½å¯¹æ¯”**

å‡è®¾æ ‘æœ‰ h å±‚ï¼Œæ¯å±‚å¹³å‡ k ä¸ªèŠ‚ç‚¹ï¼š

| æ“ä½œ | deque.appendleft() | list.insert(0) |
|------|-------------------|----------------|
| **å•æ¬¡æ“ä½œ** | O(1) | O(n) |
| **h æ¬¡æ“ä½œ** | O(h) | O(hÂ²) |
| **æ€»æ—¶é—´å¤æ‚åº¦** | **O(n)** | **O(nÂ²)** |

**å®é™…æµ‹è¯•**ï¼ˆå‡è®¾ 1000 ä¸ªèŠ‚ç‚¹ï¼Œ10 å±‚ï¼‰ï¼š

```
deque.appendleft():
- 10 æ¬¡ appendleft: 10 Ã— O(1) = O(10)
- æœ€åè½¬æ¢: O(1000)
- æ€»è®¡: O(1010) â‰ˆ O(n)

list.insert(0):
- ç¬¬1å±‚: O(0)
- ç¬¬2å±‚: O(1)
- ç¬¬3å±‚: O(2)
- ...
- ç¬¬10å±‚: O(9)
- æ€»è®¡: 0+1+2+...+9 = 45 æ¬¡ç§»åŠ¨æ“ä½œ
- ä½†æ¯æ¬¡ç§»åŠ¨å¯èƒ½æ¶‰åŠå¤šä¸ªå…ƒç´ ï¼Œå®é™…æ›´æ…¢
```

---

## ä¸ºä»€ä¹ˆä½ çš„æ–¹æ³•æ²¡é—®é¢˜ï¼Ÿ

### âœ… **æ­£ç¡®æ€§**
- Top-down éå†ï¼Œç„¶ååå‘å­˜å‚¨ â†’ ç»“æœæ­£ç¡®
- é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºç†è§£

### âœ… **æ•ˆç‡**
- `deque.appendleft()` æ˜¯ O(1) æ“ä½œ
- æœ€å `list()` è½¬æ¢æ˜¯ O(n)ï¼Œä½†åªæ‰§è¡Œä¸€æ¬¡
- æ€»ä½“æ—¶é—´å¤æ‚åº¦ï¼šO(n)

### âœ… **ä»£ç è´¨é‡**
- ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„ï¼ˆdeque ç”¨äºåŒç«¯æ“ä½œï¼‰
- æœ€åç»Ÿä¸€è½¬æ¢ï¼Œé¿å…é¢‘ç¹ç±»å‹è½¬æ¢

---

## æ–¹æ³•3ï¼šå…ˆæ”¶é›†å†åè½¬ï¼ˆå¦ä¸€ç§æ€è·¯ï¼‰

```python
def levelOrderBottom(root: Optional[TreeNode]) -> List[List[int]]:
    if not root:
        return []
        
    res = []  # æ™®é€š list
    q = deque([root])

    while q:
        sz = len(q)
        cur_lev_res = []
        for _ in range(sz):
            cur = q.popleft()
            
            if cur.left:
                q.append(cur.left)
            if cur.right:
                q.append(cur.right)

            cur_lev_res.append(cur.val)
        
        res.append(cur_lev_res)  # O(1) è¿½åŠ 

    return res[::-1]  # O(n) åè½¬
```

**æ—¶é—´å¤æ‚åº¦ï¼šO(n)**
- æ¯å±‚ `append()`: O(1) Ã— h = O(h)
- æœ€å `[::-1]` åè½¬: O(n)
- æ€»æ—¶é—´: O(n)

**ç©ºé—´å¤æ‚åº¦ï¼šO(n)**
- ä¸­é—´å­˜å‚¨ï¼š`list` O(n)
- åè½¬æ—¶ï¼šåŸ `list` + æ–° `list` = çŸ­æš‚ 2n
- å®é™…ï¼šO(n)

---

## æ–¹æ³•1 vs æ–¹æ³•3ï¼šè¯¦ç»†å¯¹æ¯”

### **æ ¸å¿ƒé—®é¢˜ï¼šæ—¢ç„¶éƒ½éœ€è¦é¢å¤– O(n) ç©ºé—´ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦ï¼š
- ä¸­é—´å­˜å‚¨ï¼šO(n)
- æœ€ç»ˆè½¬æ¢/åè½¬ï¼šO(n)
- å³°å€¼ç©ºé—´ï¼š2nï¼ˆçŸ­æš‚ï¼‰

### **è¯¦ç»†å¯¹æ¯”è¡¨**

| ç‰¹æ€§ | æ–¹æ³•1: `deque.appendleft()` | æ–¹æ³•3: `list.append()` + `[::-1]` |
|------|---------------------------|--------------------------------|
| **æ—¶é—´å¤æ‚åº¦** | O(n) | O(n) |
| **ç©ºé—´å¤æ‚åº¦** | O(n) | O(n) |
| **å³°å€¼ç©ºé—´** | çŸ­æš‚ 2nï¼ˆdeque + listï¼‰ | çŸ­æš‚ 2nï¼ˆåŸ list + æ–° listï¼‰ |
| **ä»£ç ç®€æ´æ€§** | éœ€è¦ `deque` | âœ… æ›´ç®€æ´ï¼ˆåªç”¨ `list`ï¼‰ |
| **è¯­ä¹‰æ¸…æ™°åº¦** | âœ… æ›´æ¸…æ™°ï¼ˆä»åå¾€å‰æ·»åŠ ï¼‰ | éœ€è¦ç†è§£åè½¬æ“ä½œ |
| **ä¸­é—´æ•°æ®ç»“æ„** | `deque` | `list` |
| **æœ€ç»ˆæ“ä½œ** | `list(res_q)` è½¬æ¢ | `res[::-1]` åè½¬ |

### **å®é™…æ€§èƒ½å·®å¼‚**

#### **1. å†…å­˜ä½¿ç”¨**

```python
# æ–¹æ³•1: deque.appendleft()
res_q = deque()  # ä¸­é—´ï¼šdequeï¼ˆåŒå‘é“¾è¡¨/å¾ªç¯æ•°ç»„ï¼‰
# ... æ·»åŠ æ•°æ® ...
return list(res_q)  # è½¬æ¢ï¼šéå† dequeï¼Œåˆ›å»ºæ–° list

# æ–¹æ³•3: list.append() + [::-1]
res = []  # ä¸­é—´ï¼šlistï¼ˆåŠ¨æ€æ•°ç»„ï¼‰
# ... æ·»åŠ æ•°æ® ...
return res[::-1]  # åè½¬ï¼šåˆ›å»ºæ–° listï¼ˆæµ…æ‹·è´ï¼‰
```

**å†…å­˜å¼€é”€**ï¼š
- `deque`ï¼šæ¯ä¸ªèŠ‚ç‚¹æœ‰é¢å¤–çš„æŒ‡é’ˆå¼€é”€ï¼ˆåŒå‘é“¾è¡¨ï¼‰æˆ–å—ç®¡ç†å¼€é”€ï¼ˆå¾ªç¯æ•°ç»„ï¼‰
- `list`ï¼šè¿ç»­å†…å­˜ï¼Œæ›´ç´§å‡‘
- **ç»“è®º**ï¼š`list` çš„å†…å­˜æ•ˆç‡ç•¥é«˜ï¼ˆä½†å·®å¼‚å¾ˆå°ï¼‰

#### **2. è½¬æ¢/åè½¬æ“ä½œ**

```python
# æ–¹æ³•1: list(res_q)
# éœ€è¦éå† dequeï¼Œé€ä¸ªå¤åˆ¶å…ƒç´ åˆ°æ–° list
result = []
for item in res_q:
    result.append(item)  # æˆ–ä½¿ç”¨ list() æ„é€ å‡½æ•°ï¼ˆC å®ç°ï¼Œæ›´å¿«ï¼‰

# æ–¹æ³•3: res[::-1]
# Python å†…éƒ¨ä¼˜åŒ–ï¼šç›´æ¥åˆ›å»ºæ–° listï¼Œåå‘å¤åˆ¶
# è¿™æ˜¯ C å®ç°çš„åˆ‡ç‰‡æ“ä½œï¼Œéå¸¸å¿«
```

**æ€§èƒ½**ï¼š
- `list(res_q)`ï¼šéœ€è¦éå† `deque` ç»“æ„ï¼Œå¯èƒ½ç¨æ…¢
- `[::-1]`ï¼šPython å†…éƒ¨ä¼˜åŒ–ï¼ˆC å®ç°ï¼‰ï¼Œé€šå¸¸æ›´å¿«
- **ç»“è®º**ï¼š`[::-1]` å¯èƒ½ç•¥å¿«ï¼ˆä½†å·®å¼‚å¾ˆå°ï¼Œéƒ½æ˜¯ O(n)ï¼‰

#### **3. ä»£ç å¯è¯»æ€§**

```python
# æ–¹æ³•1: è¯­ä¹‰æ¸…æ™°
res_q.appendleft(cur_lev_res)  # æ˜ç¡®è¡¨ç¤º"ä»å¤´éƒ¨æ·»åŠ "
return list(res_q)  # è½¬æ¢ä¸º list

# æ–¹æ³•3: éœ€è¦ç†è§£åè½¬
res.append(cur_lev_res)  # æ­£å¸¸è¿½åŠ 
return res[::-1]  # éœ€è¦çŸ¥é“è¿™æ˜¯åè½¬æ“ä½œ
```

**å¯è¯»æ€§**ï¼š
- `appendleft()`ï¼šæ›´ç¬¦åˆ"ä»åå¾€å‰æ·»åŠ "çš„è¯­ä¹‰
- `[::-1]`ï¼šéœ€è¦ç†è§£åˆ‡ç‰‡åè½¬çš„è¯­æ³•
- **ç»“è®º**ï¼š`appendleft()` è¯­ä¹‰æ›´æ¸…æ™°

---

### **å®é™…æµ‹è¯•å¯¹æ¯”**

```python
import time
from collections import deque

# æµ‹è¯•æ•°æ®ï¼šå‡è®¾æœ‰ 1000 ä¸ªèŠ‚ç‚¹ï¼Œ10 å±‚
# æ–¹æ³•1: deque.appendleft()
def method1():
    res_q = deque()
    for i in range(10):
        res_q.appendleft([j for j in range(100)])
    return list(res_q)

# æ–¹æ³•3: list.append() + [::-1]
def method3():
    res = []
    for i in range(10):
        res.append([j for j in range(100)])
    return res[::-1]

# æ€§èƒ½æµ‹è¯•
n = 10000
start = time.time()
for _ in range(n):
    method1()
time1 = time.time() - start

start = time.time()
for _ in range(n):
    method3()
time2 = time.time() - start

print(f"deque.appendleft(): {time1:.4f}s")
print(f"list.append() + [::-1]: {time2:.4f}s")
print(f"Speedup: {time1/time2:.2f}x")
```

**é¢„æœŸç»“æœ**ï¼š
- `[::-1]` å¯èƒ½ç•¥å¿«ï¼ˆä½†å·®å¼‚å¾ˆå°ï¼Œé€šå¸¸ < 10%ï¼‰
- ä¸¤ç§æ–¹æ³•éƒ½å¾ˆå¿«ï¼Œå·®å¼‚å¯ä»¥å¿½ç•¥

---

### **é€‰æ‹©å»ºè®®**

#### **æ¨èï¼š`list.append()` + `[::-1]`** âœ…

**ç†ç”±**ï¼š
1. âœ… **ä»£ç æ›´ç®€æ´**ï¼šä¸éœ€è¦å¯¼å…¥ `deque`ï¼Œåªç”¨æ ‡å‡† `list`
2. âœ… **æ€§èƒ½å¯èƒ½ç•¥å¥½**ï¼š`[::-1]` æ˜¯ C å®ç°çš„ä¼˜åŒ–æ“ä½œ
3. âœ… **å†…å­˜æ•ˆç‡ç•¥é«˜**ï¼š`list` æ¯” `deque` æ›´ç´§å‡‘
4. âœ… **Pythonic**ï¼šåˆ‡ç‰‡æ“ä½œæ˜¯ Python çš„æƒ¯ç”¨æ³•

**é€‚ç”¨åœºæ™¯**ï¼š
- ä»£ç ç®€æ´æ€§ä¼˜å…ˆ
- ä¸éœ€è¦é¢‘ç¹çš„åŒç«¯æ“ä½œ
- æœ€ç»ˆç»“æœéœ€è¦åè½¬

#### **å¤‡é€‰ï¼š`deque.appendleft()`** âœ…

**ç†ç”±**ï¼š
1. âœ… **è¯­ä¹‰æ›´æ¸…æ™°**ï¼šæ˜ç¡®è¡¨ç¤º"ä»å¤´éƒ¨æ·»åŠ "
2. âœ… **é€»è¾‘æ›´ç›´è§‚**ï¼šä¸éœ€è¦ç†è§£åè½¬æ“ä½œ
3. âœ… **é€‚åˆæ‰©å±•**ï¼šå¦‚æœåç»­éœ€è¦åŒç«¯æ“ä½œï¼Œ`deque` æ›´æ–¹ä¾¿

**é€‚ç”¨åœºæ™¯**ï¼š
- ä»£ç å¯è¯»æ€§ä¼˜å…ˆ
- éœ€è¦é¢‘ç¹çš„åŒç«¯æ“ä½œ
- å›¢é˜Ÿä¸ç†Ÿæ‚‰åˆ‡ç‰‡è¯­æ³•

---

### **æœ€ç»ˆç»“è®º**

| æ–¹é¢ | æ–¹æ³•1: `deque.appendleft()` | æ–¹æ³•3: `list.append()` + `[::-1]` |
|------|---------------------------|--------------------------------|
| **æ—¶é—´å¤æ‚åº¦** | O(n) | O(n) |
| **ç©ºé—´å¤æ‚åº¦** | O(n) | O(n) |
| **å®é™…æ€§èƒ½** | ç•¥æ…¢ï¼ˆä½†å·®å¼‚å¾ˆå°ï¼‰ | ç•¥å¿«ï¼ˆC å®ç°ä¼˜åŒ–ï¼‰ |
| **ä»£ç ç®€æ´æ€§** | éœ€è¦ `deque` | âœ… æ›´ç®€æ´ |
| **è¯­ä¹‰æ¸…æ™°åº¦** | âœ… æ›´æ¸…æ™° | éœ€è¦ç†è§£åè½¬ |
| **æ¨èåº¦** | â­â­â­â­ | â­â­â­â­â­ |

**å»ºè®®**ï¼š
- **ä¸€èˆ¬æƒ…å†µ**ï¼šæ¨è `list.append()` + `[::-1]`ï¼ˆæ›´ç®€æ´ã€æ›´å¿«ï¼‰
- **éœ€è¦æ¸…æ™°è¯­ä¹‰**ï¼šä½¿ç”¨ `deque.appendleft()`ï¼ˆæ›´ç›´è§‚ï¼‰
- **ä¸¤ç§æ–¹æ³•éƒ½å¾ˆå¥½**ï¼Œé€‰æ‹©ä¸»è¦çœ‹ä¸ªäºº/å›¢é˜Ÿåå¥½

---

## æ€»ç»“

### **æ¨èæ–¹æ³•æ’åº**

1. **ğŸ¥‡ deque.appendleft() + list()**ï¼ˆä½ çš„æ–¹æ³•ï¼‰
   - âœ… æ—¶é—´å¤æ‚åº¦ï¼šO(n)
   - âœ… è¯­ä¹‰æ¸…æ™°ï¼ˆä»åå¾€å‰æ·»åŠ ï¼‰
   - âœ… ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„

2. **ğŸ¥ˆ list.append() + [::-1]**
   - âœ… æ—¶é—´å¤æ‚åº¦ï¼šO(n)
   - âœ… ä»£ç æ›´ç®€æ´
   - âš ï¸ æœ‰é¢å¤–ç©ºé—´å¼€é”€

3. **ğŸ¥‰ list.insert(0, ...)**
   - âŒ æ—¶é—´å¤æ‚åº¦ï¼šO(nÂ²)
   - âŒ æ€§èƒ½å·®ï¼Œä¸æ¨è

### **å…³é”®è¦ç‚¹**

1. **æ—¶é—´å¤æ‚åº¦å¯¹æ¯”ï¼ˆæœ€é‡è¦ï¼‰**
   - `deque.appendleft()`: O(1) Ã— h + O(n) è½¬æ¢ = **O(n)** âœ…
   - `list.insert(0)`: O(n) Ã— h = **O(nÂ²)** âŒ

2. **ç©ºé—´å¤æ‚åº¦å¯¹æ¯”**
   - `deque.appendleft()`: O(n)ï¼ˆè½¬æ¢æ—¶çŸ­æš‚åŒå€ï¼Œä½†å¾ˆå¿«é‡Šæ”¾ï¼‰
   - `list.insert(0)`: O(n)ï¼ˆå§‹ç»ˆå•å€ï¼‰
   - **ç»“è®º**ï¼šç©ºé—´å¤æ‚åº¦ç›¸åŒï¼Œä½† `deque` æœ‰çŸ­æš‚çš„é¢å¤–å¼€é”€

3. **æƒè¡¡åˆ†æ**
   - âœ… **æ—¶é—´å¤æ‚åº¦ä¼˜åŠ¿**ï¼š`deque` æ–¹æ³•å¿«å¾—å¤šï¼ˆO(n) vs O(nÂ²)ï¼‰
   - âš ï¸ **ç©ºé—´å¼€é”€**ï¼š`deque` æ–¹æ³•è½¬æ¢æ—¶æœ‰çŸ­æš‚çš„åŒå€ç©ºé—´
   - âœ… **å®é™…å½±å“**ï¼šæ—¶é—´ä¼˜åŠ¿è¿œå¤§äºç©ºé—´å¼€é”€ï¼ˆç©ºé—´åªæ˜¯çŸ­æš‚çš„åŒå€ï¼Œæ—¶é—´å·®æ˜¯ O(n) vs O(nÂ²)ï¼‰

4. **ä½ çš„æ–¹æ³•å®Œå…¨æ­£ç¡®**
   - é€»è¾‘æ­£ç¡®
   - æ—¶é—´å¤æ‚åº¦æœ€ä¼˜ï¼šO(n)
   - ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼ˆç¬¦åˆè¦æ±‚ï¼‰
   - ä»£ç æ¸…æ™°

5. **é€‰æ‹©åŸåˆ™**
   - éœ€è¦åŒç«¯æ“ä½œ â†’ ç”¨ `deque`
   - éœ€è¦éšæœºè®¿é—® â†’ ç”¨ `list`
   - é¿å…åœ¨ `list` å¤´éƒ¨é¢‘ç¹æ’å…¥
   - **ä¼˜å…ˆè€ƒè™‘æ—¶é—´å¤æ‚åº¦**ï¼ˆç©ºé—´å¼€é”€é€šå¸¸æ˜¯æ¬¡è¦çš„ï¼‰

---

## æ€§èƒ½æµ‹è¯•å»ºè®®

å¯ä»¥å†™ä¸ªç®€å•çš„æµ‹è¯•æ¥éªŒè¯ï¼š

```python
import time
from collections import deque

# æµ‹è¯• insert(0) vs appendleft()
n = 10000

# æ–¹æ³•1: list.insert(0)
start = time.time()
res1 = []
for i in range(n):
    res1.insert(0, i)
time1 = time.time() - start

# æ–¹æ³•2: deque.appendleft()
start = time.time()
res2 = deque()
for i in range(n):
    res2.appendleft(i)
res2 = list(res2)
time2 = time.time() - start

print(f"list.insert(0): {time1:.4f}s")
print(f"deque.appendleft(): {time2:.4f}s")
print(f"Speedup: {time1/time2:.2f}x")
```

é¢„æœŸç»“æœï¼š`deque.appendleft()` ä¼šå¿«å¾ˆå¤šå€ï¼

---

## å…³äºç©ºé—´å¼€é”€çš„æ·±å…¥åˆ†æ

### **Q: `deque` è½¬ `list` éœ€è¦é¢å¤–ç©ºé—´ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ `list.insert(0)`ï¼Ÿ**

**A: è™½ç„¶éœ€è¦é¢å¤–ç©ºé—´ï¼Œä½†æ—¶é—´ä¼˜åŠ¿æ›´é‡è¦ï¼**

#### **ç©ºé—´å¼€é”€åˆ†æ**

```python
# æ–¹æ³•1: deque.appendleft()
res_q = deque()  # ç©ºé—´ï¼šO(n)
# ... æ·»åŠ æ•°æ® ...
return list(res_q)  # è½¬æ¢æ—¶ï¼šdeque O(n) + list O(n) = çŸ­æš‚ 2n

# æ–¹æ³•2: list.insert(0)
res = []  # ç©ºé—´ï¼šO(n)
# ... æ¯æ¬¡ insert(0) ...
return res  # å§‹ç»ˆï¼šO(n)
```

**å…³é”®ç‚¹ï¼š**
1. **ç©ºé—´å¤æ‚åº¦ç›¸åŒ**ï¼šéƒ½æ˜¯ O(n)ï¼ˆå¤§ O å¿½ç•¥å¸¸æ•°å› å­ï¼‰
2. **æ—¶é—´å·®å¼‚å·¨å¤§**ï¼šO(n) vs O(nÂ²)
3. **å®é™…å½±å“**ï¼š
   - ç©ºé—´ï¼šçŸ­æš‚çš„ 2nï¼ˆå¾ˆå¿«é‡Šæ”¾ï¼‰vs æŒç»­çš„ n
   - æ—¶é—´ï¼šO(n) vs O(nÂ²)ï¼Œå·®å¼‚éš n å¢é•¿è€Œæ€¥å‰§å¢å¤§

#### **å®é™…åœºæ™¯**

å‡è®¾æ ‘æœ‰ 1000 ä¸ªèŠ‚ç‚¹ï¼š

```
deque.appendleft():
- ç©ºé—´ï¼šçŸ­æš‚ 2Ã—1000 = 2000 ä¸ªå¼•ç”¨ï¼ˆå¾ˆå¿«é‡Šæ”¾ï¼‰
- æ—¶é—´ï¼šO(1000) â‰ˆ 1000 æ¬¡æ“ä½œ

list.insert(0):
- ç©ºé—´ï¼šæŒç»­ 1000 ä¸ªå¼•ç”¨
- æ—¶é—´ï¼šO(1000Â²) â‰ˆ 1,000,000 æ¬¡æ“ä½œ âš ï¸
```

**ç»“è®º**ï¼šæ—¶é—´ä¼˜åŠ¿ï¼ˆ1000 vs 1,000,000ï¼‰è¿œå¤§äºç©ºé—´å¼€é”€ï¼ˆçŸ­æš‚åŒå€ï¼‰

#### **Python å†…å­˜ç®¡ç†**

```python
res_q = deque()  # åˆ›å»º deque å¯¹è±¡
# ... ä½¿ç”¨ ...
result = list(res_q)  # åˆ›å»º list å¯¹è±¡
# æ­¤æ—¶ï¼šdeque å’Œ list åŒæ—¶å­˜åœ¨
return result
# å‡½æ•°è¿”å›åï¼šdeque çš„å¼•ç”¨è®¡æ•°ä¸º 0ï¼Œç«‹å³è¢« GC å›æ”¶
```

**Python çš„å¼•ç”¨è®¡æ•°æœºåˆ¶**ï¼š
- `deque` å¯¹è±¡åœ¨ `list(res_q)` æ‰§è¡Œåï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼Œä¼šç«‹å³è¢«å›æ”¶
- åŒå€ç©ºé—´å­˜åœ¨çš„æ—¶é—´éå¸¸çŸ­ï¼ˆé€šå¸¸ < 1msï¼‰

---

### **æœ€ç»ˆå»ºè®®**

1. **ä¼˜å…ˆè€ƒè™‘æ—¶é—´å¤æ‚åº¦**
   - O(n) vs O(nÂ²) çš„å·®å¼‚è¿œå¤§äºç©ºé—´å¼€é”€
   - ç©ºé—´åªæ˜¯çŸ­æš‚çš„å¸¸æ•°å€ï¼Œæ—¶é—´å·®å¼‚æ˜¯æ•°é‡çº§çš„

2. **ç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ O(n)**
   - å¤§ O è¡¨ç¤ºæ³•å¿½ç•¥å¸¸æ•°å› å­
   - ä¸¤ç§æ–¹æ³•åœ¨ç©ºé—´ä¸Šéƒ½æ˜¯ O(n)

3. **å®é™…é€‰æ‹©**
   - âœ… **æ¨è**ï¼š`deque.appendleft()`ï¼ˆæ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)ï¼‰
   - âŒ **ä¸æ¨è**ï¼š`list.insert(0)`ï¼ˆæ—¶é—´ O(nÂ²)ï¼Œç©ºé—´ O(n)ï¼‰
   - âœ… **å¤‡é€‰**ï¼š`list.append()` + `[::-1]`ï¼ˆæ—¶é—´ O(n)ï¼Œç©ºé—´ O(n)ï¼Œä½† `[::-1]` ä¹Ÿåˆ›å»ºæ–°åˆ—è¡¨ï¼‰

**ä½ çš„æ–¹æ³•ï¼ˆdeque.appendleftï¼‰æ˜¯æœ€ä¼˜çš„ï¼** ğŸ¯

